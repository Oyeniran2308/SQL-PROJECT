

/*	PROJECT TITLE: USA online shopping analysis
	DATE: 3rd of May, 2025
	OBJECTIVE: To carryout Exploratory Data Analysis on the USA online shopping dataset.
	DATASET DESCRIPTION: The USA online shopping dataset contain details about company,
						 the industry they belong, revenue generated, state and city their headquater are located.*/

EXEC sp_help USA_ONLINE_1

-- [CLEANING PROCESS]

SELECT *
FROM 
USA_ONLINE_1 --(View table)

ALTER TABLE 
USA_ONLINE_1
DROP COLUMN 
Column9, Column10; -- (Cleaning process(Column removed)

Update 
USA_ONLINE_1
SET 
Revenue_growth = Replace(Revenue_growth, '%','') ---  Cleaning process (removing of %)

-- ANALYSIS

--1 Count of Company
	SELECT 
	COUNT(*)  CompanyCount
	FROM USA_ONLINE_1

--2 Count of Industry
	SELECT 
	COUNT(DISTINCT Industry)  'No. of Industry'
	FROM USA_ONLINE_1

--3	TOP 10 REVENUE GENERATED BY EACH COMPANY

	SELECT 
	Name Company, Revenue_USD_millions
	FROM 
	USA_ONLINE_1
	GROUP BY Name, Revenue_USD_millions
	ORDER BY Revenue_USD_millions desc

--4 REVENUE GENERATED BY EACH INDUSTRY
	SELECT Industry, MAX(Revenue_USD_millions) MAX_Revenue, Name
	FROM 
	USA_ONLINE_1
	GROUP BY Industry, Name
	ORDER BY MAX(Revenue_USD_millions) desc

--5 REVENUE GENERATED BY STATE
	SELECT  
	DISTINCT State,
	SUM(Revenue_USD_millions)  'Total Revenue'
	FROM USA_ONLINE_1
	GROUP BY State
	ORDER BY State desc

--6 REVENUE GENERATED BY CITY
	SELECT
	DISTINCT(Headquarters_City),
	SUM(Revenue_USD_millions)  'Total Revenue'
	FROM USA_ONLINE_1
	GROUP BY Headquarters_City
	ORDER BY Headquarters_City desc

--7 COUNT OF COMPANY BY INDUSTRY
	SELECT Industry, 
	COUNT(*)  CompanyCount
	FROM USA_ONLINE_1
	GROUP BY Industry
	ORDER BY CompanyCount DESC;

--8 REVENUE GROWTH BY INDUSTRY
	SELECT 
	Industry, 
	MAX(CAST(Revenue_growth AS FLOAT)) AS Max_Revenue_Growth
	FROM 
	USA_ONLINE_1
	GROUP BY Industry
	ORDER BY Max_Revenue_Growth DESC;

--8 TOP 10 COMPANY BY EMPLOYEE
	SELECT 
	TOP 10 Name Company, Employees
	FROM USA_ONLINE_1
	GROUP by Name, Employees
	ORDER BY Employees DESC

--9 STATE WITH MOST COMPANY
	SELECT
	STATE,
	COUNT(Name) 'Number of Company'
	FROM USA_ONLINE_1
	GROUP BY State
	ORDER BY 'Number of Company'  desc

--10 COMPANIES WITH REVENUE GROWTH ABOVE 60%
	SELECT 
	Name Company, Industry,
	Revenue_growth
	FROM 
	USA_ONLINE_1
	WHERE Revenue_growth > =60.00
	GROUP BY Name,Revenue_growth, Industry
	ORDER BY Revenue_growth desc;

--11 COMPANIES WITH REVENUE OVER $100,000 
	SELECT
	Name Company, Revenue_USD_millions
	FROM USA_ONLINE_1
	WHERE Revenue_USD_millions >=100000
	GROUP BY Name, Revenue_USD_millions
	ORDER BY Revenue_USD_millions DESC;

--12 COMPANY GROUPING BY REVENUE (Company Revenue between 0 and 49999 are start up, revenue between 5000 and 299999 are growing company, while revenue above 300000 are Matured) )
	SELECT 
    NAME AS COMPANY, 
    Revenue_USD_millions,
	Revenue_growth,
    CASE
        WHEN Revenue_USD_millions BETWEEN 0 AND 49999 THEN 'Start Up'
        WHEN Revenue_USD_millions BETWEEN 50000 AND 299999 THEN 'Growing'
        WHEN Revenue_USD_millions >300000 THEN 'Matured'
        ELSE 'NILL'
		END AS COMPANY_STATUS
	FROM USA_ONLINE_1
	ORDER BY COMPANY_STATUS;

--13 COMPANY WITH HIGH GROWTH BUT LOW REVENUE (earn less revenue but have high growth)
	SELECT 
		Name as 'Company',
		Industry,
		Revenue_USD_Millions,
		Revenue_growth
	FROM USA_ONLINE_1
	WHERE Revenue_USD_Millions < 50000 AND Revenue_growth > 20.00
	ORDER BY Revenue_growth DESC;

--14 PROJECTED REVENUE FOR NEXT YEAR
	SELECT 
		Name Company,
		Revenue_USD_Millions AS Current_Revenue,
		Revenue_growth,
		ROUND(Revenue_USD_Millions * (1 + CAST(Revenue_growth AS FLOAT)/100), 2) AS Projected_Revenue
	FROM USA_ONLINE_1
	ORDER BY Projected_Revenue DESC

--15 COUNT OF COMPANY STATUS
	SELECT 
		CASE
        WHEN Revenue_USD_millions BETWEEN 0 AND 49999 THEN 'Start Up'
        WHEN Revenue_USD_millions BETWEEN 50000 AND 299999 THEN 'Growing'
        WHEN Revenue_USD_millions > 300000 THEN 'Matured'
        ELSE 'NILL'
		END AS COMPANY_STATUS,
		COUNT(*) AS Number_of_Companies
	FROM USA_ONLINE_1
	GROUP BY 
		CASE
        WHEN Revenue_USD_millions BETWEEN 0 AND 49999 THEN 'Start Up'
        WHEN Revenue_USD_millions BETWEEN 50000 AND 299999 THEN 'Growing'
        WHEN Revenue_USD_millions > 300000 THEN 'Matured'
        ELSE 'NILL'
		END
	ORDER BY Number_of_Companies DESC;

	/*

FINDINGS AND INSIGHT

1. Dataset Overview:
   The analysis was conducted on 100 companies, classified under 37 unique industries across various U.S. states and cities.

2. Top Revenue-Generating Companies:  
   - Walmart (Retail Industry) recorded the highest revenue of $611,289 million.  
   - Qualcomm (Technology Industry) generated $44,200 million, with a 172.96% revenue difference compared to Walmart.

3. Industry Revenue Performance:  
   - The Retail industry generated the highest cumulative revenue. 
   - Other notable industries include Retail & Cloud Computing.  
   - The Laboratory Instrument industry recorded the lowest overall revenue.

4. Top Revenue by State:
   - Washington led all states with a total revenue of $939,207 million.  
   - Arkansas reported the lowest state-level revenue.

5. Top Revenue by City/County:  
   - Woonsocket generated the highest city-level revenue with $322,467 million.  
   - Arlington County reported the lowest at $67,074 million.

6. Company Distribution by Industry:  
   - Financials had the most companies (11).  
   - Followed by Petroleum and Retail industries, each with 10 companies.  
   - Other industries such as Transportation, Health Insurance, Aerospace & Defense, Food Industry, and Food Processing had 2 companies each.  
   - Several industries had only 1 company represented, including Infotech, Apparel, Automotive, Beverage, Logistics, Media, Telecom Hardware, and others.

7. Summary of Company Count by Industry (Top Industries):  
   - Financials: 11 companies  
   - Petroleum &  Retail: 10 each  
   - Technology: 8  
   - Pharmaceuticals: 7  
   - Healthcare: 6  
   - Insurance: 5  
   - Conglomerates: 4  
   - Airlines and Telecommunications: 3 each  
   - Multiple others with 2 or 1 company as detailed above.

8. High Revenue, Low Representation:  
   Industries like Health and Electronics, despite having only one company each, reported revenues that placed them among the top 10 revenue-generating companies.

9. Notable Growth Example:  
   - Infotech Industry (represented solely by TD Synnex) generated $62,344 million, ranking 25th by revenue.  
   - Despite this, it posted an impressive revenue growth rate of 97.2%, indicating high potential.

10. Workforce Impact:  
   - Walmart employed over 2 million individuals, the highest among all companies, significantly contributing to its revenue performance and industry dominance.

11. State-wise Company Distribution:  
   - New York, Texas, and California host the highest number of companies.  
   - States with the lowest company counts include Idaho, Rhode Island, Oregon, Indiana, Kentucky, Maryland, Missouri, Nebraska, and Cook County (Illinois).

12. Top Growth Performers (60%+ Growth):  
   The following companies reported **revenue growth above 60%**:
   - TD Synnex(Infotech)  
   - World Fuel Services (Petroleum & Logistics)  
   - United Airlines, Delta Air Lines, American Airlines (Airlines)  
   - PBF Energy, ConocoPhillips** (Petroleum)  
   - Performance Food Group (Food Processing)

13. Revenue Distribution:
   - 38 companiesgenerated revenue exceeding $100,000 million.

14. Company Growth Stage Classification:
   Based on revenue brackets:
   - Startups(< $50,000 million): 13 companies  
   - Growing Companies($50,000 � $299,999 million): 80 companies  
   - Matured Companies(> $300,000 million): 7 companies

RECOMMENDATION

1. Invest in Emerging Sectors: High-growth companies in the Infotech, Petroleum & Logistics, 
   and Airlines sectors show promising ROI potential and warrant closer attention.

2. Support Start-Ups: With only 13 start-ups identified, programs aimed at nurturing early-stage 
   companies�especially in underrepresented states�can diversify the economic landscape.

3. Leverage Regional Leaders: States like Washington, New York, and California can be strategic bases for expansion, 
   partnerships, or market research.

4. Monitor Industry Performance: Industries with only one company but high revenue (e.g., Electronics, Health) may offer untapped potential.

CONCLUSION

The analysis highlights significant disparities in revenue generation and growth potential across industries and states. 
While large companies like Walmart drive top-line performance, lesser-represented industries (e.g., Infotech, Electronics) 
are showing strong growth signals. Geographically, states like Washington and California emerge as economic hotspots, 
while others remain underrepresented.

FURTHER ANALYSIS

1. Correlation Between Employee Size and Revenue: Does larger staff directly impact revenue performance?

2. Profitability vs. Revenue: Investigate net profit margins, not just revenue.

3. Time Series Analysis: Evaluate company performance over multiple years.

4. State-Level Policy Impact: Examine how tax or business policies affect company concentration by state.
